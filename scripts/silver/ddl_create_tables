
USE DataWarehouse;  -- database where silver schema lives
GO

-- The script checks whether the table (object) exists in the DB. 
-- If it exists, it is first droped and then created. 
-- Creating the customer information table - 'silver.crm_cust_info'
IF OBJECT_ID ('silver.crm_cust_info', 'U') IS NOT NULL -- U - User Defined Object
	DROP TABLE silver.crm_cust_info;
CREATE TABLE silver.crm_cust_info (
cst_id				INT, 
cst_key				NVARCHAR(50),
cst_firstname		NVARCHAR(50), 
cst_lastname		NVARCHAR(50), 
cst_marital_status NVARCHAR(50),
cst_gender			NVARCHAR(50),
cst_create_date		DATE,
dwh_create_date DATETIME2 DEFAULT GETDATE() ------- For Data Engineers to track historizations. 
);
GO

--Create the production information table - 'silver.crm_prd_info'

IF OBJECT_ID ('silver.crm_prd_info', 'U') IS NOT NULL
	DROP TABLE silver.crm_prd_info;
CREATE TABLE silver.crm_prd_info (
prd_id			INT,
cat_id			NVARCHAR (50),
prd_key			NVARCHAR(50),
prd_nm			NVARCHAR(50),
prd_cost		INT,
prd_line		NVARCHAR(50),
prd_start_date	DATE, 
prd_end_date		DATE,
dwh_create_date DATETIME2 DEFAULT GETDATE() ------- For Data Engineers to track historizations. 
);
GO

-- Creating the sales details table - 'silver.crm_sales_details'
IF OBJECT_ID ('silver.crm_sales_details', 'U') IS NOT NULL
	DROP TABLE silver.crm_sales_details;
CREATE TABLE silver.crm_sales_details (
sales_order_number		NVARCHAR(50),
sales_product_key		NVARCHAR(50),
sales_customer_id		INT,
sales_order_date		DATE,
sales_ship_date			DATE,
sales_due_date			DATE,
sales_sales				INT, 
sales_quantity			INT, 
sales_price				INT,
dwh_create_date DATETIME2 DEFAULT GETDATE() ------- For Data Engineers to track historizations. 
);
GO

-- ===================================================================================

-- Creating the customer information table from erp system - 'silver.erp_cust'
IF OBJECT_ID ('silver.erp_cust', 'U') IS NOT NULL
	DROP TABLE silver.erp_cust;
CREATE TABLE silver.erp_cust (
cid				NVARCHAR (50),
cust_bdate		DATE,
cust_gen		VARCHAR (10),
dwh_create_date DATETIME2 DEFAULT GETDATE() ------- For Data Engineers to track historizations. 
);
GO

-- Creating the customer location table from erp system - 'silver.erp_loc'
IF OBJECT_ID ('silver.erp_loc', 'U') IS NOT NULL
	DROP TABLE silver.erp_loc;
CREATE TABLE silver.erp_loc (
loc_cid				NVARCHAR (50),
loc_cntry			VARCHAR (50),
dwh_create_date		DATETIME2 DEFAULT GETDATE() ------- For Data Engineers to track historizations. 
);
GO

-- Creating the product category table from erp system - 'silver.erp_loc'
IF OBJECT_ID ('silver.erp_px_cat', 'U') IS NOT NULL
	DROP TABLE silver.erp_px_cat;
CREATE TABLE silver.erp_px_cat (
pr_cat_id				VARCHAR (50), 
px_cat_cat				VARCHAR (50),
px_cat_subcat			VARCHAR (50),
px_cat_maintenance		VARCHAR (50),
dwh_create_date			DATETIME2 DEFAULT GETDATE() ------- For Data Engineers to track historizations. 
);
GO

